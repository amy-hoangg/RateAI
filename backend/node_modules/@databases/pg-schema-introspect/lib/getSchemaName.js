"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

const pg_1 = require("@databases/pg");

async function getSchemaName(connection, schemaID) {
  const namespaces = await connection.query(pg_1.sql`SELECT nspname FROM pg_catalog.pg_namespace WHERE oid = ${schemaID}`);

  if (namespaces.length !== 1) {
    throw new Error(`Could not find schema with oid ${schemaID}`);
  }

  return namespaces[0].nspname;
}

exports.default = getSchemaName;